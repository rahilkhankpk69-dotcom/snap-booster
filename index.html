<!DOCTYPE html>
<html>
<head>
  <title>Demo Login</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

<h2>Demo Login</h2>

<input type="text" id="username" placeholder="Username"><br><br>
<input type="password" id="password" placeholder="Password"><br><br>

<button onclick="signup()">Sign Up</button>
<button onclick="login()">Login</button>

<p id="msg"></p>

<script>
// Supabase setup
const supabaseUrl = "https://mdcsbpbrcvudxbdjchwt.supabase.co";
const supabaseKey = "sb_publishable_jqIhtEIHIqtwYCmx5cpKsQ_0GwVPr6X";
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

async function signup(){
  const user = document.getElementById("username").value.trim();
  const pass = document.getElementById("password").value.trim();

  if(!user || !pass){ alert("Fill both fields"); return; }

  // Insert user
  const { data, error } = await supabase.from("users")
    .insert([{ username: user, password: pass }]);

  if(error){
    document.getElementById("msg").innerText = "Error: " + error.message;
    console.log(error);
  } else {
    document.getElementById("msg").innerText = "User signed up successfully!";
  }
}

async function login(){
  const user = document.getElementById("username").value.trim();
  const pass = document.getElementById("password").value.trim();

  if(!user || !pass){ alert("Fill both fields"); return; }

  const { data, error } = await supabase.from("users")
    .select("*")
    .eq("username", user)
    .single();

  if(error || !data){
    document.getElementById("msg").innerText = "User not found!";
    console.log(error);
    return;
  }

  if(data.password === pass){
    document.getElementById("msg").innerText = "Login success!";
  } else {
    document.getElementById("msg").innerText = "Wrong password!";
  }
}
</script>

</body>
</html>
